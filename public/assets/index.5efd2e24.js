var je=Object.defineProperty;var He=(r,t,e)=>t in r?je(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var U=(r,t,e)=>(He(r,typeof t!="symbol"?t+"":t,e),e);const Je=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}};Je();class Ye{constructor(t,e,n){this.eventTarget=t,this.eventName=e,this.eventOptions=n,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(t){this.unorderedBindings.add(t)}bindingDisconnected(t){this.unorderedBindings.delete(t)}handleEvent(t){const e=We(t);for(const n of this.bindings){if(e.immediatePropagationStopped)break;n.handleEvent(e)}}get bindings(){return Array.from(this.unorderedBindings).sort((t,e)=>{const n=t.index,s=e.index;return n<s?-1:n>s?1:0})}}function We(r){if("immediatePropagationStopped"in r)return r;{const{stopImmediatePropagation:t}=r;return Object.assign(r,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,t.call(this)}})}}class Ge{constructor(t){this.application=t,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(t=>t.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(t=>t.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((t,e)=>t.concat(Array.from(e.values())),[])}bindingConnected(t){this.fetchEventListenerForBinding(t).bindingConnected(t)}bindingDisconnected(t){this.fetchEventListenerForBinding(t).bindingDisconnected(t)}handleError(t,e,n={}){this.application.handleError(t,`Error ${e}`,n)}fetchEventListenerForBinding(t){const{eventTarget:e,eventName:n,eventOptions:s}=t;return this.fetchEventListener(e,n,s)}fetchEventListener(t,e,n){const s=this.fetchEventListenerMapForEventTarget(t),i=this.cacheKey(e,n);let o=s.get(i);return o||(o=this.createEventListener(t,e,n),s.set(i,o)),o}createEventListener(t,e,n){const s=new Ye(t,e,n);return this.started&&s.connect(),s}fetchEventListenerMapForEventTarget(t){let e=this.eventListenerMaps.get(t);return e||(e=new Map,this.eventListenerMaps.set(t,e)),e}cacheKey(t,e){const n=[t];return Object.keys(e).sort().forEach(s=>{n.push(`${e[s]?"":"!"}${s}`)}),n.join(":")}}const Qe=/^((.+?)(@(window|document))?->)?(.+?)(#([^:]+?))(:(.+))?$/;function Xe(r){const e=r.trim().match(Qe)||[];return{eventTarget:Ze(e[4]),eventName:e[2],eventOptions:e[9]?tn(e[9]):{},identifier:e[5],methodName:e[7]}}function Ze(r){if(r=="window")return window;if(r=="document")return document}function tn(r){return r.split(":").reduce((t,e)=>Object.assign(t,{[e.replace(/^!/,"")]:!/^!/.test(e)}),{})}function en(r){if(r==window)return"window";if(r==document)return"document"}function ce(r){return r.replace(/(?:[_-])([a-z0-9])/g,(t,e)=>e.toUpperCase())}function ut(r){return r.charAt(0).toUpperCase()+r.slice(1)}function he(r){return r.replace(/([A-Z])/g,(t,e)=>`-${e.toLowerCase()}`)}function nn(r){return r.match(/[^\s]+/g)||[]}class rn{constructor(t,e,n){this.element=t,this.index=e,this.eventTarget=n.eventTarget||t,this.eventName=n.eventName||sn(t)||bt("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||bt("missing identifier"),this.methodName=n.methodName||bt("missing method name")}static forToken(t){return new this(t.element,t.index,Xe(t.content))}toString(){const t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${t}->${this.identifier}#${this.methodName}`}get params(){return this.eventTarget instanceof Element?this.getParamsFromEventTargetAttributes(this.eventTarget):{}}getParamsFromEventTargetAttributes(t){const e={},n=new RegExp(`^data-${this.identifier}-(.+)-param$`);return Array.from(t.attributes).forEach(({name:i,value:o})=>{const a=i.match(n),c=a&&a[1];c&&Object.assign(e,{[ce(c)]:on(o)})}),e}get eventTargetName(){return en(this.eventTarget)}}const Yt={a:r=>"click",button:r=>"click",form:r=>"submit",details:r=>"toggle",input:r=>r.getAttribute("type")=="submit"?"click":"input",select:r=>"change",textarea:r=>"input"};function sn(r){const t=r.tagName.toLowerCase();if(t in Yt)return Yt[t](r)}function bt(r){throw new Error(r)}function on(r){try{return JSON.parse(r)}catch{return r}}class an{constructor(t,e){this.context=t,this.action=e}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(t){this.willBeInvokedByEvent(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const t=this.controller[this.methodName];if(typeof t=="function")return t;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}invokeWithEvent(t){const{target:e,currentTarget:n}=t;try{const{params:s}=this.action,i=Object.assign(t,{params:s});this.method.call(this.controller,i),this.context.logDebugActivity(this.methodName,{event:t,target:e,currentTarget:n,action:this.methodName})}catch(s){const{identifier:i,controller:o,element:a,index:c}=this,h={identifier:i,controller:o,element:a,index:c,event:t};this.context.handleError(s,`invoking action "${this.action}"`,h)}}willBeInvokedByEvent(t){const e=t.target;return this.element===e?!0:e instanceof Element&&this.element.contains(e)?this.scope.containsElement(e):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class cn{constructor(t,e){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=t,this.started=!1,this.delegate=e,this.elements=new Set,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(t){this.started&&(this.mutationObserver.disconnect(),this.started=!1),t(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const t=new Set(this.matchElementsInTree());for(const e of Array.from(this.elements))t.has(e)||this.removeElement(e);for(const e of Array.from(t))this.addElement(e)}}processMutations(t){if(this.started)for(const e of t)this.processMutation(e)}processMutation(t){t.type=="attributes"?this.processAttributeChange(t.target,t.attributeName):t.type=="childList"&&(this.processRemovedNodes(t.removedNodes),this.processAddedNodes(t.addedNodes))}processAttributeChange(t,e){const n=t;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,e):this.removeElement(n):this.matchElement(n)&&this.addElement(n)}processRemovedNodes(t){for(const e of Array.from(t)){const n=this.elementFromNode(e);n&&this.processTree(n,this.removeElement)}}processAddedNodes(t){for(const e of Array.from(t)){const n=this.elementFromNode(e);n&&this.elementIsActive(n)&&this.processTree(n,this.addElement)}}matchElement(t){return this.delegate.matchElement(t)}matchElementsInTree(t=this.element){return this.delegate.matchElementsInTree(t)}processTree(t,e){for(const n of this.matchElementsInTree(t))e.call(this,n)}elementFromNode(t){if(t.nodeType==Node.ELEMENT_NODE)return t}elementIsActive(t){return t.isConnected!=this.element.isConnected?!1:this.element.contains(t)}addElement(t){this.elements.has(t)||this.elementIsActive(t)&&(this.elements.add(t),this.delegate.elementMatched&&this.delegate.elementMatched(t))}removeElement(t){this.elements.has(t)&&(this.elements.delete(t),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(t))}}class hn{constructor(t,e,n){this.attributeName=e,this.delegate=n,this.elementObserver=new cn(t,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(t){return t.hasAttribute(this.attributeName)}matchElementsInTree(t){const e=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector));return e.concat(n)}elementMatched(t){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(t,this.attributeName)}elementUnmatched(t){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(t,this.attributeName)}elementAttributeChanged(t,e){this.delegate.elementAttributeValueChanged&&this.attributeName==e&&this.delegate.elementAttributeValueChanged(t,e)}}class un{constructor(t,e){this.element=t,this.delegate=e,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const t of this.knownAttributeNames)this.refreshAttribute(t,null)}processMutations(t){if(this.started)for(const e of t)this.processMutation(e)}processMutation(t){const e=t.attributeName;e&&this.refreshAttribute(e,t.oldValue)}refreshAttribute(t,e){const n=this.delegate.getStringMapKeyForAttribute(t);if(n!=null){this.stringMap.has(t)||this.stringMapKeyAdded(n,t);const s=this.element.getAttribute(t);if(this.stringMap.get(t)!=s&&this.stringMapValueChanged(s,n,e),s==null){const i=this.stringMap.get(t);this.stringMap.delete(t),i&&this.stringMapKeyRemoved(n,t,i)}else this.stringMap.set(t,s)}}stringMapKeyAdded(t,e){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(t,e)}stringMapValueChanged(t,e,n){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(t,e,n)}stringMapKeyRemoved(t,e,n){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(t,e,n)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(t=>t.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}function ln(r,t,e){ue(r,t).add(e)}function dn(r,t,e){ue(r,t).delete(e),fn(r,t)}function ue(r,t){let e=r.get(t);return e||(e=new Set,r.set(t,e)),e}function fn(r,t){const e=r.get(t);e!=null&&e.size==0&&r.delete(t)}class It{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((e,n)=>e.concat(Array.from(n)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((e,n)=>e+n.size,0)}add(t,e){ln(this.valuesByKey,t,e)}delete(t,e){dn(this.valuesByKey,t,e)}has(t,e){const n=this.valuesByKey.get(t);return n!=null&&n.has(e)}hasKey(t){return this.valuesByKey.has(t)}hasValue(t){return Array.from(this.valuesByKey.values()).some(n=>n.has(t))}getValuesForKey(t){const e=this.valuesByKey.get(t);return e?Array.from(e):[]}getKeysForValue(t){return Array.from(this.valuesByKey).filter(([e,n])=>n.has(t)).map(([e,n])=>e)}}class le{constructor(t,e,n){this.attributeObserver=new hn(t,e,this),this.delegate=n,this.tokensByElement=new It}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(t){this.attributeObserver.pause(t)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(t){this.tokensMatched(this.readTokensForElement(t))}elementAttributeValueChanged(t){const[e,n]=this.refreshTokensForElement(t);this.tokensUnmatched(e),this.tokensMatched(n)}elementUnmatchedAttribute(t){this.tokensUnmatched(this.tokensByElement.getValuesForKey(t))}tokensMatched(t){t.forEach(e=>this.tokenMatched(e))}tokensUnmatched(t){t.forEach(e=>this.tokenUnmatched(e))}tokenMatched(t){this.delegate.tokenMatched(t),this.tokensByElement.add(t.element,t)}tokenUnmatched(t){this.delegate.tokenUnmatched(t),this.tokensByElement.delete(t.element,t)}refreshTokensForElement(t){const e=this.tokensByElement.getValuesForKey(t),n=this.readTokensForElement(t),s=gn(e,n).findIndex(([i,o])=>!mn(i,o));return s==-1?[[],[]]:[e.slice(s),n.slice(s)]}readTokensForElement(t){const e=this.attributeName,n=t.getAttribute(e)||"";return pn(n,t,e)}}function pn(r,t,e){return r.trim().split(/\s+/).filter(n=>n.length).map((n,s)=>({element:t,attributeName:e,content:n,index:s}))}function gn(r,t){const e=Math.max(r.length,t.length);return Array.from({length:e},(n,s)=>[r[s],t[s]])}function mn(r,t){return r&&t&&r.index==t.index&&r.content==t.content}class de{constructor(t,e,n){this.tokenListObserver=new le(t,e,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(t){const{element:e}=t,{value:n}=this.fetchParseResultForToken(t);n&&(this.fetchValuesByTokenForElement(e).set(t,n),this.delegate.elementMatchedValue(e,n))}tokenUnmatched(t){const{element:e}=t,{value:n}=this.fetchParseResultForToken(t);n&&(this.fetchValuesByTokenForElement(e).delete(t),this.delegate.elementUnmatchedValue(e,n))}fetchParseResultForToken(t){let e=this.parseResultsByToken.get(t);return e||(e=this.parseToken(t),this.parseResultsByToken.set(t,e)),e}fetchValuesByTokenForElement(t){let e=this.valuesByTokenByElement.get(t);return e||(e=new Map,this.valuesByTokenByElement.set(t,e)),e}parseToken(t){try{return{value:this.delegate.parseValueForToken(t)}}catch(e){return{error:e}}}}class yn{constructor(t,e){this.context=t,this.delegate=e,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new de(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(t){const e=new an(this.context,t);this.bindingsByAction.set(t,e),this.delegate.bindingConnected(e)}disconnectAction(t){const e=this.bindingsByAction.get(t);e&&(this.bindingsByAction.delete(t),this.delegate.bindingDisconnected(e))}disconnectAllActions(){this.bindings.forEach(t=>this.delegate.bindingDisconnected(t)),this.bindingsByAction.clear()}parseValueForToken(t){const e=rn.forToken(t);if(e.identifier==this.identifier)return e}elementMatchedValue(t,e){this.connectAction(e)}elementUnmatchedValue(t,e){this.disconnectAction(e)}}class bn{constructor(t,e){this.context=t,this.receiver=e,this.stringMapObserver=new un(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap,this.invokeChangedCallbacksForDefaultValues()}start(){this.stringMapObserver.start()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(t){if(t in this.valueDescriptorMap)return this.valueDescriptorMap[t].name}stringMapKeyAdded(t,e){const n=this.valueDescriptorMap[e];this.hasValue(t)||this.invokeChangedCallback(t,n.writer(this.receiver[t]),n.writer(n.defaultValue))}stringMapValueChanged(t,e,n){const s=this.valueDescriptorNameMap[e];t!==null&&(n===null&&(n=s.writer(s.defaultValue)),this.invokeChangedCallback(e,t,n))}stringMapKeyRemoved(t,e,n){const s=this.valueDescriptorNameMap[t];this.hasValue(t)?this.invokeChangedCallback(t,s.writer(this.receiver[t]),n):this.invokeChangedCallback(t,s.writer(s.defaultValue),n)}invokeChangedCallbacksForDefaultValues(){for(const{key:t,name:e,defaultValue:n,writer:s}of this.valueDescriptors)n!=null&&!this.controller.data.has(t)&&this.invokeChangedCallback(e,s(n),void 0)}invokeChangedCallback(t,e,n){const s=`${t}Changed`,i=this.receiver[s];if(typeof i=="function"){const o=this.valueDescriptorNameMap[t],a=o.reader(e);let c=n;n&&(c=o.reader(n)),i.call(this.receiver,a,c)}}get valueDescriptors(){const{valueDescriptorMap:t}=this;return Object.keys(t).map(e=>t[e])}get valueDescriptorNameMap(){const t={};return Object.keys(this.valueDescriptorMap).forEach(e=>{const n=this.valueDescriptorMap[e];t[n.name]=n}),t}hasValue(t){const e=this.valueDescriptorNameMap[t],n=`has${ut(e.name)}`;return this.receiver[n]}}class wn{constructor(t,e){this.context=t,this.delegate=e,this.targetsByName=new It}start(){this.tokenListObserver||(this.tokenListObserver=new le(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:t,content:e}){this.scope.containsElement(t)&&this.connectTarget(t,e)}tokenUnmatched({element:t,content:e}){this.disconnectTarget(t,e)}connectTarget(t,e){var n;this.targetsByName.has(e,t)||(this.targetsByName.add(e,t),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetConnected(t,e)))}disconnectTarget(t,e){var n;this.targetsByName.has(e,t)&&(this.targetsByName.delete(e,t),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetDisconnected(t,e)))}disconnectAllTargets(){for(const t of this.targetsByName.keys)for(const e of this.targetsByName.getValuesForKey(t))this.disconnectTarget(e,t)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}class vn{constructor(t,e){this.logDebugActivity=(n,s={})=>{const{identifier:i,controller:o,element:a}=this;s=Object.assign({identifier:i,controller:o,element:a},s),this.application.logDebugActivity(this.identifier,n,s)},this.module=t,this.scope=e,this.controller=new t.controllerConstructor(this),this.bindingObserver=new yn(this,this.dispatcher),this.valueObserver=new bn(this,this.controller),this.targetObserver=new wn(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(n){this.handleError(n,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(t){this.handleError(t,"connecting controller")}}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(t){this.handleError(t,"disconnecting controller")}this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(t,e,n={}){const{identifier:s,controller:i,element:o}=this;n=Object.assign({identifier:s,controller:i,element:o},n),this.application.handleError(t,`Error ${e}`,n)}targetConnected(t,e){this.invokeControllerMethod(`${e}TargetConnected`,t)}targetDisconnected(t,e){this.invokeControllerMethod(`${e}TargetDisconnected`,t)}invokeControllerMethod(t,...e){const n=this.controller;typeof n[t]=="function"&&n[t](...e)}}function Pt(r,t){const e=fe(r);return Array.from(e.reduce((n,s)=>(An(s,t).forEach(i=>n.add(i)),n),new Set))}function En(r,t){return fe(r).reduce((n,s)=>(n.push(...Cn(s,t)),n),[])}function fe(r){const t=[];for(;r;)t.push(r),r=Object.getPrototypeOf(r);return t.reverse()}function An(r,t){const e=r[t];return Array.isArray(e)?e:[]}function Cn(r,t){const e=r[t];return e?Object.keys(e).map(n=>[n,e[n]]):[]}function Bn(r){return Tn(r,kn(r))}function Tn(r,t){const e=Mn(r),n=Nn(r.prototype,t);return Object.defineProperties(e.prototype,n),e}function kn(r){return Pt(r,"blessings").reduce((e,n)=>{const s=n(r);for(const i in s){const o=e[i]||{};e[i]=Object.assign(o,s[i])}return e},{})}function Nn(r,t){return On(t).reduce((e,n)=>{const s=Sn(r,t,n);return s&&Object.assign(e,{[n]:s}),e},{})}function Sn(r,t,e){const n=Object.getOwnPropertyDescriptor(r,e);if(!(n&&"value"in n)){const i=Object.getOwnPropertyDescriptor(t,e).value;return n&&(i.get=n.get||i.get,i.set=n.set||i.set),i}}const On=(()=>typeof Object.getOwnPropertySymbols=="function"?r=>[...Object.getOwnPropertyNames(r),...Object.getOwnPropertySymbols(r)]:Object.getOwnPropertyNames)(),Mn=(()=>{function r(e){function n(){return Reflect.construct(e,arguments,new.target)}return n.prototype=Object.create(e.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,e),n}function t(){const n=r(function(){this.a.call(this)});return n.prototype.a=function(){},new n}try{return t(),r}catch{return n=>class extends n{}}})();function Rn(r){return{identifier:r.identifier,controllerConstructor:Bn(r.controllerConstructor)}}class Ln{constructor(t,e){this.application=t,this.definition=Rn(e),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(t){const e=this.fetchContextForScope(t);this.connectedContexts.add(e),e.connect()}disconnectContextForScope(t){const e=this.contextsByScope.get(t);e&&(this.connectedContexts.delete(e),e.disconnect())}fetchContextForScope(t){let e=this.contextsByScope.get(t);return e||(e=new vn(this,t),this.contextsByScope.set(t,e)),e}}class _n{constructor(t){this.scope=t}has(t){return this.data.has(this.getDataKey(t))}get(t){return this.getAll(t)[0]}getAll(t){const e=this.data.get(this.getDataKey(t))||"";return nn(e)}getAttributeName(t){return this.data.getAttributeNameForKey(this.getDataKey(t))}getDataKey(t){return`${t}-class`}get data(){return this.scope.data}}class In{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(t){const e=this.getAttributeNameForKey(t);return this.element.getAttribute(e)}set(t,e){const n=this.getAttributeNameForKey(t);return this.element.setAttribute(n,e),this.get(t)}has(t){const e=this.getAttributeNameForKey(t);return this.element.hasAttribute(e)}delete(t){if(this.has(t)){const e=this.getAttributeNameForKey(t);return this.element.removeAttribute(e),!0}else return!1}getAttributeNameForKey(t){return`data-${this.identifier}-${he(t)}`}}class Pn{constructor(t){this.warnedKeysByObject=new WeakMap,this.logger=t}warn(t,e,n){let s=this.warnedKeysByObject.get(t);s||(s=new Set,this.warnedKeysByObject.set(t,s)),s.has(e)||(s.add(e),this.logger.warn(n,t))}}function Bt(r,t){return`[${r}~="${t}"]`}class Dn{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return this.find(t)!=null}find(...t){return t.reduce((e,n)=>e||this.findTarget(n)||this.findLegacyTarget(n),void 0)}findAll(...t){return t.reduce((e,n)=>[...e,...this.findAllTargets(n),...this.findAllLegacyTargets(n)],[])}findTarget(t){const e=this.getSelectorForTargetName(t);return this.scope.findElement(e)}findAllTargets(t){const e=this.getSelectorForTargetName(t);return this.scope.findAllElements(e)}getSelectorForTargetName(t){const e=this.schema.targetAttributeForScope(this.identifier);return Bt(e,t)}findLegacyTarget(t){const e=this.getLegacySelectorForTargetName(t);return this.deprecate(this.scope.findElement(e),t)}findAllLegacyTargets(t){const e=this.getLegacySelectorForTargetName(t);return this.scope.findAllElements(e).map(n=>this.deprecate(n,t))}getLegacySelectorForTargetName(t){const e=`${this.identifier}.${t}`;return Bt(this.schema.targetAttribute,e)}deprecate(t,e){if(t){const{identifier:n}=this,s=this.schema.targetAttribute,i=this.schema.targetAttributeForScope(n);this.guide.warn(t,`target:${e}`,`Please replace ${s}="${n}.${e}" with ${i}="${e}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return t}get guide(){return this.scope.guide}}class Fn{constructor(t,e,n,s){this.targets=new Dn(this),this.classes=new _n(this),this.data=new In(this),this.containsElement=i=>i.closest(this.controllerSelector)===this.element,this.schema=t,this.element=e,this.identifier=n,this.guide=new Pn(s)}findElement(t){return this.element.matches(t)?this.element:this.queryElements(t).find(this.containsElement)}findAllElements(t){return[...this.element.matches(t)?[this.element]:[],...this.queryElements(t).filter(this.containsElement)]}queryElements(t){return Array.from(this.element.querySelectorAll(t))}get controllerSelector(){return Bt(this.schema.controllerAttribute,this.identifier)}}class xn{constructor(t,e,n){this.element=t,this.schema=e,this.delegate=n,this.valueListObserver=new de(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(t){const{element:e,content:n}=t,s=this.fetchScopesByIdentifierForElement(e);let i=s.get(n);return i||(i=this.delegate.createScopeForElementAndIdentifier(e,n),s.set(n,i)),i}elementMatchedValue(t,e){const n=(this.scopeReferenceCounts.get(e)||0)+1;this.scopeReferenceCounts.set(e,n),n==1&&this.delegate.scopeConnected(e)}elementUnmatchedValue(t,e){const n=this.scopeReferenceCounts.get(e);n&&(this.scopeReferenceCounts.set(e,n-1),n==1&&this.delegate.scopeDisconnected(e))}fetchScopesByIdentifierForElement(t){let e=this.scopesByIdentifierByElement.get(t);return e||(e=new Map,this.scopesByIdentifierByElement.set(t,e)),e}}class Vn{constructor(t){this.application=t,this.scopeObserver=new xn(this.element,this.schema,this),this.scopesByIdentifier=new It,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((t,e)=>t.concat(e.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(t){this.unloadIdentifier(t.identifier);const e=new Ln(this.application,t);this.connectModule(e)}unloadIdentifier(t){const e=this.modulesByIdentifier.get(t);e&&this.disconnectModule(e)}getContextForElementAndIdentifier(t,e){const n=this.modulesByIdentifier.get(e);if(n)return n.contexts.find(s=>s.element==t)}handleError(t,e,n){this.application.handleError(t,e,n)}createScopeForElementAndIdentifier(t,e){return new Fn(this.schema,t,e,this.logger)}scopeConnected(t){this.scopesByIdentifier.add(t.identifier,t);const e=this.modulesByIdentifier.get(t.identifier);e&&e.connectContextForScope(t)}scopeDisconnected(t){this.scopesByIdentifier.delete(t.identifier,t);const e=this.modulesByIdentifier.get(t.identifier);e&&e.disconnectContextForScope(t)}connectModule(t){this.modulesByIdentifier.set(t.identifier,t),this.scopesByIdentifier.getValuesForKey(t.identifier).forEach(n=>t.connectContextForScope(n))}disconnectModule(t){this.modulesByIdentifier.delete(t.identifier),this.scopesByIdentifier.getValuesForKey(t.identifier).forEach(n=>t.disconnectContextForScope(n))}}const Un={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:r=>`data-${r}-target`};class Dt{constructor(t=document.documentElement,e=Un){this.logger=console,this.debug=!1,this.logDebugActivity=(n,s,i={})=>{this.debug&&this.logFormattedMessage(n,s,i)},this.element=t,this.schema=e,this.dispatcher=new Ge(this),this.router=new Vn(this)}static start(t,e){const n=new Dt(t,e);return n.start(),n}async start(){await Kn(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(t,e){e.shouldLoad&&this.load({identifier:t,controllerConstructor:e})}load(t,...e){(Array.isArray(t)?t:[t,...e]).forEach(s=>this.router.loadDefinition(s))}unload(t,...e){(Array.isArray(t)?t:[t,...e]).forEach(s=>this.router.unloadIdentifier(s))}get controllers(){return this.router.contexts.map(t=>t.controller)}getControllerForElementAndIdentifier(t,e){const n=this.router.getContextForElementAndIdentifier(t,e);return n?n.controller:null}handleError(t,e,n){var s;this.logger.error(`%s

%o

%o`,e,t,n),(s=window.onerror)===null||s===void 0||s.call(window,e,"",0,0,t)}logFormattedMessage(t,e,n={}){n=Object.assign({application:this},n),this.logger.groupCollapsed(`${t} #${e}`),this.logger.log("details:",Object.assign({},n)),this.logger.groupEnd()}}function Kn(){return new Promise(r=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>r()):r()})}function $n(r){return Pt(r,"classes").reduce((e,n)=>Object.assign(e,qn(n)),{})}function qn(r){return{[`${r}Class`]:{get(){const{classes:t}=this;if(t.has(r))return t.get(r);{const e=t.getAttributeName(r);throw new Error(`Missing attribute "${e}"`)}}},[`${r}Classes`]:{get(){return this.classes.getAll(r)}},[`has${ut(r)}Class`]:{get(){return this.classes.has(r)}}}}function zn(r){return Pt(r,"targets").reduce((e,n)=>Object.assign(e,jn(n)),{})}function jn(r){return{[`${r}Target`]:{get(){const t=this.targets.find(r);if(t)return t;throw new Error(`Missing target element "${r}" for "${this.identifier}" controller`)}},[`${r}Targets`]:{get(){return this.targets.findAll(r)}},[`has${ut(r)}Target`]:{get(){return this.targets.has(r)}}}}function Hn(r){const t=En(r,"values"),e={valueDescriptorMap:{get(){return t.reduce((n,s)=>{const i=pe(s),o=this.data.getAttributeNameForKey(i.key);return Object.assign(n,{[o]:i})},{})}}};return t.reduce((n,s)=>Object.assign(n,Jn(s)),e)}function Jn(r){const t=pe(r),{key:e,name:n,reader:s,writer:i}=t;return{[n]:{get(){const o=this.data.get(e);return o!==null?s(o):t.defaultValue},set(o){o===void 0?this.data.delete(e):this.data.set(e,i(o))}},[`has${ut(n)}`]:{get(){return this.data.has(e)||t.hasCustomDefaultValue}}}}function pe([r,t]){return Qn(r,t)}function Ft(r){switch(r){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function xt(r){switch(typeof r){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(r))return"array";if(Object.prototype.toString.call(r)==="[object Object]")return"object"}function Yn(r){const t=Ft(r.type);if(t){const e=xt(r.default);if(t!==e)throw new Error(`Type "${t}" must match the type of the default value. Given default value: "${r.default}" as "${e}"`);return t}}function Wn(r){const t=Yn(r),e=xt(r),n=Ft(r),s=t||e||n;if(s)return s;throw new Error(`Unknown value type "${r}"`)}function Gn(r){const t=Ft(r);if(t)return Xn[t];const e=r.default;return e!==void 0?e:r}function Qn(r,t){const e=`${he(r)}-value`,n=Wn(t);return{type:n,key:e,name:ce(e),get defaultValue(){return Gn(t)},get hasCustomDefaultValue(){return xt(t)!==void 0},reader:Zn[n],writer:Wt[n]||Wt.default}}const Xn={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Zn={array(r){const t=JSON.parse(r);if(!Array.isArray(t))throw new TypeError("Expected array");return t},boolean(r){return!(r=="0"||r=="false")},number(r){return Number(r)},object(r){const t=JSON.parse(r);if(t===null||typeof t!="object"||Array.isArray(t))throw new TypeError("Expected object");return t},string(r){return r}},Wt={default:tr,array:Gt,object:Gt};function Gt(r){return JSON.stringify(r)}function tr(r){return`${r}`}class lt{constructor(t){this.context=t}static get shouldLoad(){return!0}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:n={},prefix:s=this.identifier,bubbles:i=!0,cancelable:o=!0}={}){const a=s?`${s}:${t}`:t,c=new CustomEvent(a,{detail:n,bubbles:i,cancelable:o});return e.dispatchEvent(c),c}}lt.blessings=[$n,zn,Hn];lt.targets=[];lt.values={};var er=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,nr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Tt=function(t){var e=t,n=t.indexOf("["),s=t.indexOf("]");n!=-1&&s!=-1&&(t=t.substring(0,n)+t.substring(n,s).replace(/:/g,";")+t.substring(s,t.length));for(var i=er.exec(t||""),o={},a=14;a--;)o[nr[a]]=i[a]||"";return n!=-1&&s!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=rr(o,o.path),o.queryKey=sr(o,o.query),o};function rr(r,t){var e=/\/{2,9}/g,n=t.replace(e,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&n.splice(0,1),t.substr(t.length-1,1)=="/"&&n.splice(n.length-1,1),n}function sr(r,t){var e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,i){s&&(e[s]=i)}),e}function ir(r,t="",e){let n=r;e=e||typeof location!="undefined"&&location,r==null&&(r=e.protocol+"//"+e.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=e.protocol+r:r=e.host+r),/^(https?|wss?):\/\//.test(r)||(typeof e!="undefined"?r=e.protocol+"//"+r:r="https://"+r),n=Tt(r)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(e&&e.port===n.port?"":":"+n.port),n}var kt={exports:{}};try{kt.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch{kt.exports=!1}var or=kt.exports,D=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())();function ge(r){const t=r.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!t||or))return new XMLHttpRequest}catch{}if(!t)try{return new D[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function me(r,...t){return t.reduce((e,n)=>(r.hasOwnProperty(n)&&(e[n]=r[n]),e),{})}const ar=setTimeout,cr=clearTimeout;function dt(r,t){t.useNativeTimers?(r.setTimeoutFn=ar.bind(D),r.clearTimeoutFn=cr.bind(D)):(r.setTimeoutFn=setTimeout.bind(D),r.clearTimeoutFn=clearTimeout.bind(D))}var j=T;function T(r){if(r)return hr(r)}function hr(r){for(var t in T.prototype)r[t]=T.prototype[t];return r}T.prototype.on=T.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};T.prototype.once=function(r,t){function e(){this.off(r,e),t.apply(this,arguments)}return e.fn=t,this.on(r,e),this};T.prototype.off=T.prototype.removeListener=T.prototype.removeAllListeners=T.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+r];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var n,s=0;s<e.length;s++)if(n=e[s],n===t||n.fn===t){e.splice(s,1);break}return e.length===0&&delete this._callbacks["$"+r],this};T.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+r],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e){e=e.slice(0);for(var n=0,s=e.length;n<s;++n)e[n].apply(this,t)}return this};T.prototype.emitReserved=T.prototype.emit;T.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};T.prototype.hasListeners=function(r){return!!this.listeners(r).length};const R=Object.create(null);R.open="0";R.close="1";R.ping="2";R.pong="3";R.message="4";R.upgrade="5";R.noop="6";const st=Object.create(null);Object.keys(R).forEach(r=>{st[R[r]]=r});const ur={type:"error",data:"parser error"},lr=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",dr=typeof ArrayBuffer=="function",fr=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,ye=({type:r,data:t},e,n)=>lr&&t instanceof Blob?e?n(t):Qt(t,n):dr&&(t instanceof ArrayBuffer||fr(t))?e?n(t):Qt(new Blob([t]),n):n(R[r]+(t||"")),Qt=(r,t)=>{const e=new FileReader;return e.onload=function(){const n=e.result.split(",")[1];t("b"+n)},e.readAsDataURL(r)};var Xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(var et=0;et<Xt.length;et++)G[Xt.charCodeAt(et)]=et;var pr=function(r){var t=r.length*.75,e=r.length,n,s=0,i,o,a,c;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var h=new ArrayBuffer(t),u=new Uint8Array(h);for(n=0;n<e;n+=4)i=G[r.charCodeAt(n)],o=G[r.charCodeAt(n+1)],a=G[r.charCodeAt(n+2)],c=G[r.charCodeAt(n+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|a>>2,u[s++]=(a&3)<<6|c&63;return h};const gr=typeof ArrayBuffer=="function",be=(r,t)=>{if(typeof r!="string")return{type:"message",data:we(r,t)};const e=r.charAt(0);return e==="b"?{type:"message",data:mr(r.substring(1),t)}:st[e]?r.length>1?{type:st[e],data:r.substring(1)}:{type:st[e]}:ur},mr=(r,t)=>{if(gr){const e=pr(r);return we(e,t)}else return{base64:!0,data:r}},we=(r,t)=>{switch(t){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}},ve=String.fromCharCode(30),yr=(r,t)=>{const e=r.length,n=new Array(e);let s=0;r.forEach((i,o)=>{ye(i,!1,a=>{n[o]=a,++s===e&&t(n.join(ve))})})},br=(r,t)=>{const e=r.split(ve),n=[];for(let s=0;s<e.length;s++){const i=be(e[s],t);if(n.push(i),i.type==="error")break}return n},Ee=4;class Ae extends j{constructor(t){super(),this.writable=!1,dt(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const n=new Error(t);return n.type="TransportError",n.description=e,super.emit("error",n),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(t){const e=be(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emit("packet",t)}onClose(){this.readyState="closed",super.emit("close")}}var Ce="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),at=64,Be={},Zt=0,F=0,te;function Nt(r){var t="";do t=Ce[r%at]+t,r=Math.floor(r/at);while(r>0);return t}function wr(r){var t=0;for(F=0;F<r.length;F++)t=t*at+Be[r.charAt(F)];return t}function Vt(){var r=Nt(+new Date);return r!==te?(Zt=0,te=r):r+"."+Nt(Zt++)}for(;F<at;F++)Be[Ce[F]]=F;Vt.encode=Nt;Vt.decode=wr;var Te=Vt,Z={};Z.encode=function(r){var t="";for(var e in r)r.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e]));return t};Z.decode=function(r){for(var t={},e=r.split("&"),n=0,s=e.length;n<s;n++){var i=e[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t};class vr extends Ae{constructor(){super(...arguments),this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||e()})),this.writable||(n++,this.once("drain",function(){--n||e()}))}else e()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){const e=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose(),!1;this.onPacket(n)};br(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,yr(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emit("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Te()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&(e==="https"&&Number(this.opts.port)!==443||e==="http"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port);const s=Z.encode(t),i=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}}function Er(){}const Ar=function(){return new ge({xdomain:!1}).responseType!=null}();class Cr extends vr{constructor(t){if(super(t),typeof location!="undefined"){const n=location.protocol==="https:";let s=location.port;s||(s=n?"443":"80"),this.xd=typeof location!="undefined"&&t.hostname!==location.hostname||s!==t.port,this.xs=t.secure!==n}const e=t&&t.forceBase64;this.supportsBinary=Ar&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new M(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",s=>{this.onError("xhr post error",s)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",e=>{this.onError("xhr poll error",e)}),this.pollXhr=t}}class M extends j{constructor(t,e){super(),dt(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=e.async!==!1,this.data=e.data!==void 0?e.data:null,this.create()}create(){const t=me(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new ge(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&e.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{e.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{e.readyState===4&&(e.status===200||e.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof e.status=="number"?e.status:0)},0))},e.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document!="undefined"&&(this.index=M.requestsCount++,M.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=Er,t)try{this.xhr.abort()}catch{}typeof document!="undefined"&&delete M.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;t!==null&&this.onData(t)}abort(){this.cleanup()}}M.requestsCount=0;M.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",ee);else if(typeof addEventListener=="function"){const r="onpagehide"in D?"pagehide":"unload";addEventListener(r,ee,!1)}}function ee(){for(let r in M.requests)M.requests.hasOwnProperty(r)&&M.requests[r].abort()}const Br=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0))(),Y=D.WebSocket||D.MozWebSocket,ne=!0,Tr="arraybuffer",re=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ut extends Ae{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=re?{}:me(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=ne&&!re?e?new Y(t,e):new Y(t):new Y(t,e,n)}catch(s){return this.emit("error",s)}this.ws.binaryType=this.socket.binaryType||Tr,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],s=e===t.length-1;ye(n,this.supportsBinary,i=>{const o={};try{ne&&this.ws.send(i)}catch{}s&&Br(()=>{this.writable=!0,this.emit("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&(e==="wss"&&Number(this.opts.port)!==443||e==="ws"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Te()),this.supportsBinary||(t.b64=1);const s=Z.encode(t),i=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}check(){return!!Y&&!("__initialize"in Y&&this.name===Ut.prototype.name)}}const kr={websocket:Ut,polling:Cr};class I extends j{constructor(t,e={}){super(),t&&typeof t=="object"&&(e=t,t=null),t?(t=Tt(t),e.hostname=t.host,e.secure=t.protocol==="https"||t.protocol==="wss",e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=Tt(e.host).host),dt(this,e),this.secure=e.secure!=null?e.secure:typeof location!="undefined"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=e.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Z.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=Nr(this.opts.query);e.EIO=Ee,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new kr[t](n)}open(){let t;if(this.opts.rememberUpgrade&&I.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(t){let e=this.createTransport(t),n=!1;I.priorWebsocketSuccess=!1;const s=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",v=>{if(!n)if(v.type==="pong"&&v.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;I.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const l=new Error("probe error");l.transport=e.name,this.emitReserved("upgradeError",l)}}))};function i(){n||(n=!0,u(),e.close(),e=null)}const o=v=>{const l=new Error("probe error: "+v);l.transport=e.name,i(),this.emitReserved("upgradeError",l)};function a(){o("transport closed")}function c(){o("socket closed")}function h(v){e&&v.name!==e.name&&i()}const u=()=>{e.removeListener("open",s),e.removeListener("error",o),e.removeListener("close",a),this.off("close",c),this.off("upgrading",h)};e.once("open",s),e.once("error",o),e.once("close",a),this.once("close",c),this.once("upgrading",h),e.open()}onOpen(){if(this.readyState="open",I.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,s){if(typeof e=="function"&&(s=e,e=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:t,data:e,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}onError(t){I.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const s=t.length;for(;n<s;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}I.protocol=Ee;function Nr(r){const t={};for(let e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);return t}I.protocol;const Sr=typeof ArrayBuffer=="function",Or=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,ke=Object.prototype.toString,Mr=typeof Blob=="function"||typeof Blob!="undefined"&&ke.call(Blob)==="[object BlobConstructor]",Rr=typeof File=="function"||typeof File!="undefined"&&ke.call(File)==="[object FileConstructor]";function Kt(r){return Sr&&(r instanceof ArrayBuffer||Or(r))||Mr&&r instanceof Blob||Rr&&r instanceof File}function it(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let e=0,n=r.length;e<n;e++)if(it(r[e]))return!0;return!1}if(Kt(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return it(r.toJSON(),!0);for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&it(r[e]))return!0;return!1}function Lr(r){const t=[],e=r.data,n=r;return n.data=St(e,t),n.attachments=t.length,{packet:n,buffers:t}}function St(r,t){if(!r)return r;if(Kt(r)){const e={_placeholder:!0,num:t.length};return t.push(r),e}else if(Array.isArray(r)){const e=new Array(r.length);for(let n=0;n<r.length;n++)e[n]=St(r[n],t);return e}else if(typeof r=="object"&&!(r instanceof Date)){const e={};for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=St(r[n],t));return e}return r}function _r(r,t){return r.data=Ot(r.data,t),r.attachments=void 0,r}function Ot(r,t){if(!r)return r;if(r&&r._placeholder)return t[r.num];if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=Ot(r[e],t);else if(typeof r=="object")for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=Ot(r[e],t));return r}const Ir=5;var w;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(w||(w={}));class Pr{encode(t){return(t.type===w.EVENT||t.type===w.ACK)&&it(t)?(t.type=t.type===w.EVENT?w.BINARY_EVENT:w.BINARY_ACK,this.encodeAsBinary(t)):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===w.BINARY_EVENT||t.type===w.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data)),e}encodeAsBinary(t){const e=Lr(t),n=this.encodeAsString(e.packet),s=e.buffers;return s.unshift(n),s}}class $t extends j{constructor(){super()}add(t){let e;if(typeof t=="string")e=this.decodeString(t),e.type===w.BINARY_EVENT||e.type===w.BINARY_ACK?(this.reconstructor=new Fr(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else if(Kt(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(w[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===w.BINARY_EVENT||n.type===w.BINARY_ACK){const i=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(i,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(t.charAt(e+1)==="/"){const i=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););n.nsp=t.substring(i,e)}else n.nsp="/";const s=t.charAt(e+1);if(s!==""&&Number(s)==s){const i=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}n.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=Dr(t.substr(e));if($t.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}static isPayloadValid(t,e){switch(t){case w.CONNECT:return typeof e=="object";case w.DISCONNECT:return e===void 0;case w.CONNECT_ERROR:return typeof e=="string"||typeof e=="object";case w.EVENT:case w.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case w.ACK:case w.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}function Dr(r){try{return JSON.parse(r)}catch{return!1}}class Fr{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=_r(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var xr=Object.freeze(Object.defineProperty({__proto__:null,protocol:Ir,get PacketType(){return w},Encoder:Pr,Decoder:$t},Symbol.toStringTag,{value:"Module"}));function S(r,t,e){return r.on(t,e),function(){r.off(t,e)}}const Vr=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ne extends j{constructor(t,e,n){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[S(t,"open",this.onopen.bind(this)),S(t,"packet",this.onpacket.bind(this)),S(t,"error",this.onerror.bind(this)),S(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Vr.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:w.EVENT,data:e};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const o=this.ids++,a=e.pop();this._registerAckCallback(o,a),n.id=o}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?this.packet(n):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(n===void 0){this.acks[t]=e;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===t&&this.sendBuffer.splice(i,1);e.call(this,new Error("operation has timed out"))},n);this.acks[t]=(...i)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...i])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this.packet({type:w.CONNECT,data:t})}):this.packet({type:w.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case w.CONNECT:if(t.data&&t.data.sid){const s=t.data.sid;this.onconnect(s)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case w.EVENT:this.onevent(t);break;case w.BINARY_EVENT:this.onevent(t);break;case w.ACK:this.onack(t);break;case w.BINARY_ACK:this.onack(t);break;case w.DISCONNECT:this.ondisconnect();break;case w.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...s){n||(n=!0,e.packet({type:w.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>this.packet(t)),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:w.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var Ur=H;function H(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}H.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*r);r=(Math.floor(t*10)&1)==0?r-e:r+e}return Math.min(r,this.max)|0};H.prototype.reset=function(){this.attempts=0};H.prototype.setMin=function(r){this.ms=r};H.prototype.setMax=function(r){this.max=r};H.prototype.setJitter=function(r){this.jitter=r};class Mt extends j{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,dt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((n=e.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Ur({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||xr;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new I(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=S(e,"open",function(){n.onopen(),t&&t()}),i=S(e,"error",o=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",o),t?t(o):n.maybeReconnectOnOpen()});if(this._timeout!==!1){const o=this._timeout;o===0&&s();const a=this.setTimeoutFn(()=>{s(),e.close(),e.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(s),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(S(t,"ping",this.onping.bind(this)),S(t,"data",this.ondata.bind(this)),S(t,"error",this.onerror.bind(this)),S(t,"close",this.onclose.bind(this)),S(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new Ne(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const n of e)if(this.nsps[n].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},e);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const W={};function ot(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const e=ir(r,t.path||"/socket.io"),n=e.source,s=e.id,i=e.path,o=W[s]&&i in W[s].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return a?c=new Mt(n,t):(W[s]||(W[s]=new Mt(n,t)),c=W[s]),e.query&&!t.query&&(t.query=e.queryKey),c.socket(e.path,t)}Object.assign(ot,{Manager:Mt,Socket:Ne,io:ot,connect:ot});function Kr(){const r=[];return{bind:n=>{r.push(n)},trigger:n=>{r.forEach(s=>{typeof s=="function"&&s(n)})}}}class $r{constructor(t){U(this,"id",null);U(this,"_pairListener",Kr());U(this,"_socket");this._socket=t,this._socket.on("paapi:paired",this._pairListener.trigger)}waitFor(t){return new Promise(e=>{this._socket.once(t,n=>{e(n)})})}async pair(t){return this.connected||await this.waitFor("connect"),this._socket.emit("paapi:join",t),this.id=await this.waitFor("paapi:joined"),this}onPair(t){this._pairListener.bind(t)}get paired(){return this.id!==null}get socket(){return this._socket}get connected(){return this._socket.connected}get disconnected(){return this._socket.disconnected}send(t,...e){return this._socket.send(t,...e)}emit(t,...e){return this._socket.emit(t,...e)}on(t,e){return this._socket.on(t,e)}onAny(t){return this._socket.onAny(t)}prependAny(t){return this._socket.prependAny(t)}offAny(t){return this._socket.offAny(t)}once(t,e){return this._socket.once(t,e)}listeners(t){return this._socket.listeners(t)}listenersAny(){return this._socket.listenersAny()}off(t,e){return this._socket.off(t,e)}compress(t){return this._socket.compress(t)}timeout(t){return this._socket.timeout(t)}connect(){return this._socket.connect()}open(){return this._socket.open()}close(){return this._socket.close()}disconnect(){return this._socket.disconnect()}get volatile(){return this._socket.volatile}}function qr(r="https://paapi.pnk.network/"){return new $r(ot(r))}var zr=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Se={},k={};let qt;const jr=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];k.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};k.getSymbolTotalCodewords=function(t){return jr[t]};k.getBCHDigit=function(r){let t=0;for(;r!==0;)t++,r>>>=1;return t};k.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');qt=t};k.isKanjiModeEnabled=function(){return typeof qt!="undefined"};k.toSJIS=function(t){return qt(t)};var ft={};(function(r){r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2};function t(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw new Error("Unknown EC Level: "+e)}}r.isValid=function(n){return n&&typeof n.bit!="undefined"&&n.bit>=0&&n.bit<4},r.from=function(n,s){if(r.isValid(n))return n;try{return t(n)}catch{return s}}})(ft);function Oe(){this.buffer=[],this.length=0}Oe.prototype={get:function(r){const t=Math.floor(r/8);return(this.buffer[t]>>>7-r%8&1)===1},put:function(r,t){for(let e=0;e<t;e++)this.putBit((r>>>t-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),r&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Hr=Oe;function tt(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}tt.prototype.set=function(r,t,e,n){const s=r*this.size+t;this.data[s]=e,n&&(this.reservedBit[s]=!0)};tt.prototype.get=function(r,t){return this.data[r*this.size+t]};tt.prototype.xor=function(r,t,e){this.data[r*this.size+t]^=e};tt.prototype.isReserved=function(r,t){return this.reservedBit[r*this.size+t]};var Jr=tt,Me={};(function(r){const t=k.getSymbolSize;r.getRowColCoords=function(n){if(n===1)return[];const s=Math.floor(n/7)+2,i=t(n),o=i===145?26:Math.ceil((i-13)/(2*s-2))*2,a=[i-7];for(let c=1;c<s-1;c++)a[c]=a[c-1]-o;return a.push(6),a.reverse()},r.getPositions=function(n){const s=[],i=r.getRowColCoords(n),o=i.length;for(let a=0;a<o;a++)for(let c=0;c<o;c++)a===0&&c===0||a===0&&c===o-1||a===o-1&&c===0||s.push([i[a],i[c]]);return s}})(Me);var Re={};const Yr=k.getSymbolSize,se=7;Re.getPositions=function(t){const e=Yr(t);return[[0,0],[e-se,0],[0,e-se]]};var Le={};(function(r){r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};r.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},r.from=function(s){return r.isValid(s)?parseInt(s,10):void 0},r.getPenaltyN1=function(s){const i=s.size;let o=0,a=0,c=0,h=null,u=null;for(let v=0;v<i;v++){a=c=0,h=u=null;for(let l=0;l<i;l++){let d=s.get(v,l);d===h?a++:(a>=5&&(o+=t.N1+(a-5)),h=d,a=1),d=s.get(l,v),d===u?c++:(c>=5&&(o+=t.N1+(c-5)),u=d,c=1)}a>=5&&(o+=t.N1+(a-5)),c>=5&&(o+=t.N1+(c-5))}return o},r.getPenaltyN2=function(s){const i=s.size;let o=0;for(let a=0;a<i-1;a++)for(let c=0;c<i-1;c++){const h=s.get(a,c)+s.get(a,c+1)+s.get(a+1,c)+s.get(a+1,c+1);(h===4||h===0)&&o++}return o*t.N2},r.getPenaltyN3=function(s){const i=s.size;let o=0,a=0,c=0;for(let h=0;h<i;h++){a=c=0;for(let u=0;u<i;u++)a=a<<1&2047|s.get(h,u),u>=10&&(a===1488||a===93)&&o++,c=c<<1&2047|s.get(u,h),u>=10&&(c===1488||c===93)&&o++}return o*t.N3},r.getPenaltyN4=function(s){let i=0;const o=s.data.length;for(let c=0;c<o;c++)i+=s.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function e(n,s,i){switch(n){case r.Patterns.PATTERN000:return(s+i)%2===0;case r.Patterns.PATTERN001:return s%2===0;case r.Patterns.PATTERN010:return i%3===0;case r.Patterns.PATTERN011:return(s+i)%3===0;case r.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2===0;case r.Patterns.PATTERN101:return s*i%2+s*i%3===0;case r.Patterns.PATTERN110:return(s*i%2+s*i%3)%2===0;case r.Patterns.PATTERN111:return(s*i%3+(s+i)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}r.applyMask=function(s,i){const o=i.size;for(let a=0;a<o;a++)for(let c=0;c<o;c++)i.isReserved(c,a)||i.xor(c,a,e(s,c,a))},r.getBestMask=function(s,i){const o=Object.keys(r.Patterns).length;let a=0,c=1/0;for(let h=0;h<o;h++){i(h),r.applyMask(h,s);const u=r.getPenaltyN1(s)+r.getPenaltyN2(s)+r.getPenaltyN3(s)+r.getPenaltyN4(s);r.applyMask(h,s),u<c&&(c=u,a=h)}return a}})(Le);var pt={};const x=ft,nt=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],rt=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];pt.getBlocksCount=function(t,e){switch(e){case x.L:return nt[(t-1)*4+0];case x.M:return nt[(t-1)*4+1];case x.Q:return nt[(t-1)*4+2];case x.H:return nt[(t-1)*4+3];default:return}};pt.getTotalCodewordsCount=function(t,e){switch(e){case x.L:return rt[(t-1)*4+0];case x.M:return rt[(t-1)*4+1];case x.Q:return rt[(t-1)*4+2];case x.H:return rt[(t-1)*4+3];default:return}};var _e={},gt={};const Q=new Uint8Array(512),ct=new Uint8Array(256);(function(){let t=1;for(let e=0;e<255;e++)Q[e]=t,ct[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)Q[e]=Q[e-255]})();gt.log=function(t){if(t<1)throw new Error("log("+t+")");return ct[t]};gt.exp=function(t){return Q[t]};gt.mul=function(t,e){return t===0||e===0?0:Q[ct[t]+ct[e]]};(function(r){const t=gt;r.mul=function(n,s){const i=new Uint8Array(n.length+s.length-1);for(let o=0;o<n.length;o++)for(let a=0;a<s.length;a++)i[o+a]^=t.mul(n[o],s[a]);return i},r.mod=function(n,s){let i=new Uint8Array(n);for(;i.length-s.length>=0;){const o=i[0];for(let c=0;c<s.length;c++)i[c]^=t.mul(s[c],o);let a=0;for(;a<i.length&&i[a]===0;)a++;i=i.slice(a)}return i},r.generateECPolynomial=function(n){let s=new Uint8Array([1]);for(let i=0;i<n;i++)s=r.mul(s,new Uint8Array([1,t.exp(i)]));return s}})(_e);const Ie=_e;function zt(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}zt.prototype.initialize=function(t){this.degree=t,this.genPoly=Ie.generateECPolynomial(this.degree)};zt.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=Ie.mod(e,this.genPoly),s=this.degree-n.length;if(s>0){const i=new Uint8Array(this.degree);return i.set(n,s),i}return n};var Wr=zt,Pe={},V={},jt={};jt.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var L={};const De="[0-9]+",Gr="[A-Z $%*+\\-./:]+";let X="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";X=X.replace(/u/g,"\\u");const Qr="(?:(?![A-Z0-9 $%*+\\-./:]|"+X+`)(?:.|[\r
]))+`;L.KANJI=new RegExp(X,"g");L.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");L.BYTE=new RegExp(Qr,"g");L.NUMERIC=new RegExp(De,"g");L.ALPHANUMERIC=new RegExp(Gr,"g");const Xr=new RegExp("^"+X+"$"),Zr=new RegExp("^"+De+"$"),ts=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");L.testKanji=function(t){return Xr.test(t)};L.testNumeric=function(t){return Zr.test(t)};L.testAlphanumeric=function(t){return ts.test(t)};(function(r){const t=jt,e=L;r.NUMERIC={id:"Numeric",bit:1<<0,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:1<<1,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:1<<2,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:1<<3,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},r.getBestModeForData=function(i){return e.testNumeric(i)?r.NUMERIC:e.testAlphanumeric(i)?r.ALPHANUMERIC:e.testKanji(i)?r.KANJI:r.BYTE},r.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},r.isValid=function(i){return i&&i.bit&&i.ccBits};function n(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw new Error("Unknown mode: "+s)}}r.from=function(i,o){if(r.isValid(i))return i;try{return n(i)}catch{return o}}})(V);(function(r){const t=k,e=pt,n=ft,s=V,i=jt,o=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,a=t.getBCHDigit(o);function c(l,d,m){for(let y=1;y<=40;y++)if(d<=r.getCapacity(y,m,l))return y}function h(l,d){return s.getCharCountIndicator(l,d)+4}function u(l,d){let m=0;return l.forEach(function(y){m+=h(y.mode,d)+y.getBitsLength()}),m}function v(l,d){for(let m=1;m<=40;m++)if(u(l,m)<=r.getCapacity(m,d,s.MIXED))return m}r.from=function(d,m){return i.isValid(d)?parseInt(d,10):m},r.getCapacity=function(d,m,y){if(!i.isValid(d))throw new Error("Invalid QR Code version");typeof y=="undefined"&&(y=s.BYTE);const B=t.getSymbolTotalCodewords(d),g=e.getTotalCodewordsCount(d,m),b=(B-g)*8;if(y===s.MIXED)return b;const p=b-h(y,d);switch(y){case s.NUMERIC:return Math.floor(p/10*3);case s.ALPHANUMERIC:return Math.floor(p/11*2);case s.KANJI:return Math.floor(p/13);case s.BYTE:default:return Math.floor(p/8)}},r.getBestVersionForData=function(d,m){let y;const B=n.from(m,n.M);if(Array.isArray(d)){if(d.length>1)return v(d,B);if(d.length===0)return 1;y=d[0]}else y=d;return c(y.mode,y.getLength(),B)},r.getEncodedBits=function(d){if(!i.isValid(d)||d<7)throw new Error("Invalid QR Code version");let m=d<<12;for(;t.getBCHDigit(m)-a>=0;)m^=o<<t.getBCHDigit(m)-a;return d<<12|m}})(Pe);var Fe={};const Rt=k,xe=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,es=1<<14|1<<12|1<<10|1<<4|1<<1,ie=Rt.getBCHDigit(xe);Fe.getEncodedBits=function(t,e){const n=t.bit<<3|e;let s=n<<10;for(;Rt.getBCHDigit(s)-ie>=0;)s^=xe<<Rt.getBCHDigit(s)-ie;return(n<<10|s)^es};var Ve={};const ns=V;function K(r){this.mode=ns.NUMERIC,this.data=r.toString()}K.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};K.prototype.getLength=function(){return this.data.length};K.prototype.getBitsLength=function(){return K.getBitsLength(this.data.length)};K.prototype.write=function(t){let e,n,s;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),s=parseInt(n,10),t.put(s,10);const i=this.data.length-e;i>0&&(n=this.data.substr(e),s=parseInt(n,10),t.put(s,i*3+1))};var rs=K;const ss=V,wt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function $(r){this.mode=ss.ALPHANUMERIC,this.data=r}$.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};$.prototype.getLength=function(){return this.data.length};$.prototype.getBitsLength=function(){return $.getBitsLength(this.data.length)};$.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let n=wt.indexOf(this.data[e])*45;n+=wt.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(wt.indexOf(this.data[e]),6)};var is=$,os=function(t){for(var e=[],n=t.length,s=0;s<n;s++){var i=t.charCodeAt(s);if(i>=55296&&i<=56319&&n>s+1){var o=t.charCodeAt(s+1);o>=56320&&o<=57343&&(i=(i-55296)*1024+o-56320+65536,s+=1)}if(i<128){e.push(i);continue}if(i<2048){e.push(i>>6|192),e.push(i&63|128);continue}if(i<55296||i>=57344&&i<65536){e.push(i>>12|224),e.push(i>>6&63|128),e.push(i&63|128);continue}if(i>=65536&&i<=1114111){e.push(i>>18|240),e.push(i>>12&63|128),e.push(i>>6&63|128),e.push(i&63|128);continue}e.push(239,191,189)}return new Uint8Array(e).buffer};const as=os,cs=V;function q(r){this.mode=cs.BYTE,this.data=new Uint8Array(as(r))}q.getBitsLength=function(t){return t*8};q.prototype.getLength=function(){return this.data.length};q.prototype.getBitsLength=function(){return q.getBitsLength(this.data.length)};q.prototype.write=function(r){for(let t=0,e=this.data.length;t<e;t++)r.put(this.data[t],8)};var hs=q;const us=V,ls=k;function z(r){this.mode=us.KANJI,this.data=r}z.getBitsLength=function(t){return t*13};z.prototype.getLength=function(){return this.data.length};z.prototype.getBitsLength=function(){return z.getBitsLength(this.data.length)};z.prototype.write=function(r){let t;for(t=0;t<this.data.length;t++){let e=ls.toSJIS(this.data[t]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),r.put(e,13)}};var ds=z,Ue={exports:{}};(function(r){var t={single_source_shortest_paths:function(e,n,s){var i={},o={};o[n]=0;var a=t.PriorityQueue.make();a.push(n,0);for(var c,h,u,v,l,d,m,y,B;!a.empty();){c=a.pop(),h=c.value,v=c.cost,l=e[h]||{};for(u in l)l.hasOwnProperty(u)&&(d=l[u],m=v+d,y=o[u],B=typeof o[u]=="undefined",(B||y>m)&&(o[u]=m,a.push(u,m),i[u]=h))}if(typeof s!="undefined"&&typeof o[s]=="undefined"){var g=["Could not find a path from ",n," to ",s,"."].join("");throw new Error(g)}return i},extract_shortest_path_from_predecessor_list:function(e,n){for(var s=[],i=n;i;)s.push(i),i=e[i];return s.reverse(),s},find_path:function(e,n,s){var i=t.single_source_shortest_paths(e,n,s);return t.extract_shortest_path_from_predecessor_list(i,s)},PriorityQueue:{make:function(e){var n=t.PriorityQueue,s={},i;e=e||{};for(i in n)n.hasOwnProperty(i)&&(s[i]=n[i]);return s.queue=[],s.sorter=e.sorter||n.default_sorter,s},default_sorter:function(e,n){return e.cost-n.cost},push:function(e,n){var s={value:e,cost:n};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};r.exports=t})(Ue);(function(r){const t=V,e=rs,n=is,s=hs,i=ds,o=L,a=k,c=Ue.exports;function h(g){return unescape(encodeURIComponent(g)).length}function u(g,b,p){const f=[];let E;for(;(E=g.exec(p))!==null;)f.push({data:E[0],index:E.index,mode:b,length:E[0].length});return f}function v(g){const b=u(o.NUMERIC,t.NUMERIC,g),p=u(o.ALPHANUMERIC,t.ALPHANUMERIC,g);let f,E;return a.isKanjiModeEnabled()?(f=u(o.BYTE,t.BYTE,g),E=u(o.KANJI,t.KANJI,g)):(f=u(o.BYTE_KANJI,t.BYTE,g),E=[]),b.concat(p,f,E).sort(function(C,N){return C.index-N.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function l(g,b){switch(b){case t.NUMERIC:return e.getBitsLength(g);case t.ALPHANUMERIC:return n.getBitsLength(g);case t.KANJI:return i.getBitsLength(g);case t.BYTE:return s.getBitsLength(g)}}function d(g){return g.reduce(function(b,p){const f=b.length-1>=0?b[b.length-1]:null;return f&&f.mode===p.mode?(b[b.length-1].data+=p.data,b):(b.push(p),b)},[])}function m(g){const b=[];for(let p=0;p<g.length;p++){const f=g[p];switch(f.mode){case t.NUMERIC:b.push([f,{data:f.data,mode:t.ALPHANUMERIC,length:f.length},{data:f.data,mode:t.BYTE,length:f.length}]);break;case t.ALPHANUMERIC:b.push([f,{data:f.data,mode:t.BYTE,length:f.length}]);break;case t.KANJI:b.push([f,{data:f.data,mode:t.BYTE,length:h(f.data)}]);break;case t.BYTE:b.push([{data:f.data,mode:t.BYTE,length:h(f.data)}])}}return b}function y(g,b){const p={},f={start:{}};let E=["start"];for(let A=0;A<g.length;A++){const C=g[A],N=[];for(let P=0;P<C.length;P++){const O=C[P],J=""+A+P;N.push(J),p[J]={node:O,lastCount:0},f[J]={};for(let yt=0;yt<E.length;yt++){const _=E[yt];p[_]&&p[_].node.mode===O.mode?(f[_][J]=l(p[_].lastCount+O.length,O.mode)-l(p[_].lastCount,O.mode),p[_].lastCount+=O.length):(p[_]&&(p[_].lastCount=O.length),f[_][J]=l(O.length,O.mode)+4+t.getCharCountIndicator(O.mode,b))}}E=N}for(let A=0;A<E.length;A++)f[E[A]].end=0;return{map:f,table:p}}function B(g,b){let p;const f=t.getBestModeForData(g);if(p=t.from(b,f),p!==t.BYTE&&p.bit<f.bit)throw new Error('"'+g+'" cannot be encoded with mode '+t.toString(p)+`.
 Suggested mode is: `+t.toString(f));switch(p===t.KANJI&&!a.isKanjiModeEnabled()&&(p=t.BYTE),p){case t.NUMERIC:return new e(g);case t.ALPHANUMERIC:return new n(g);case t.KANJI:return new i(g);case t.BYTE:return new s(g)}}r.fromArray=function(b){return b.reduce(function(p,f){return typeof f=="string"?p.push(B(f,null)):f.data&&p.push(B(f.data,f.mode)),p},[])},r.fromString=function(b,p){const f=v(b,a.isKanjiModeEnabled()),E=m(f),A=y(E,p),C=c.find_path(A.map,"start","end"),N=[];for(let P=1;P<C.length-1;P++)N.push(A.table[C[P]].node);return r.fromArray(d(N))},r.rawSplit=function(b){return r.fromArray(v(b,a.isKanjiModeEnabled()))}})(Ve);const mt=k,vt=ft,fs=Hr,ps=Jr,gs=Me,ms=Re,Lt=Le,_t=pt,ys=Wr,ht=Pe,bs=Fe,ws=V,Et=Ve;function vs(r,t){const e=r.size,n=ms.getPositions(t);for(let s=0;s<n.length;s++){const i=n[s][0],o=n[s][1];for(let a=-1;a<=7;a++)if(!(i+a<=-1||e<=i+a))for(let c=-1;c<=7;c++)o+c<=-1||e<=o+c||(a>=0&&a<=6&&(c===0||c===6)||c>=0&&c<=6&&(a===0||a===6)||a>=2&&a<=4&&c>=2&&c<=4?r.set(i+a,o+c,!0,!0):r.set(i+a,o+c,!1,!0))}}function Es(r){const t=r.size;for(let e=8;e<t-8;e++){const n=e%2===0;r.set(e,6,n,!0),r.set(6,e,n,!0)}}function As(r,t){const e=gs.getPositions(t);for(let n=0;n<e.length;n++){const s=e[n][0],i=e[n][1];for(let o=-2;o<=2;o++)for(let a=-2;a<=2;a++)o===-2||o===2||a===-2||a===2||o===0&&a===0?r.set(s+o,i+a,!0,!0):r.set(s+o,i+a,!1,!0)}}function Cs(r,t){const e=r.size,n=ht.getEncodedBits(t);let s,i,o;for(let a=0;a<18;a++)s=Math.floor(a/3),i=a%3+e-8-3,o=(n>>a&1)===1,r.set(s,i,o,!0),r.set(i,s,o,!0)}function At(r,t,e){const n=r.size,s=bs.getEncodedBits(t,e);let i,o;for(i=0;i<15;i++)o=(s>>i&1)===1,i<6?r.set(i,8,o,!0):i<8?r.set(i+1,8,o,!0):r.set(n-15+i,8,o,!0),i<8?r.set(8,n-i-1,o,!0):i<9?r.set(8,15-i-1+1,o,!0):r.set(8,15-i-1,o,!0);r.set(n-8,8,1,!0)}function Bs(r,t){const e=r.size;let n=-1,s=e-1,i=7,o=0;for(let a=e-1;a>0;a-=2)for(a===6&&a--;;){for(let c=0;c<2;c++)if(!r.isReserved(s,a-c)){let h=!1;o<t.length&&(h=(t[o]>>>i&1)===1),r.set(s,a-c,h),i--,i===-1&&(o++,i=7)}if(s+=n,s<0||e<=s){s-=n,n=-n;break}}}function Ts(r,t,e){const n=new fs;e.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),ws.getCharCountIndicator(c.mode,r)),c.write(n)});const s=mt.getSymbolTotalCodewords(r),i=_t.getTotalCodewordsCount(r,t),o=(s-i)*8;for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const a=(o-n.getLengthInBits())/8;for(let c=0;c<a;c++)n.put(c%2?17:236,8);return ks(n,r,t)}function ks(r,t,e){const n=mt.getSymbolTotalCodewords(t),s=_t.getTotalCodewordsCount(t,e),i=n-s,o=_t.getBlocksCount(t,e),a=n%o,c=o-a,h=Math.floor(n/o),u=Math.floor(i/o),v=u+1,l=h-u,d=new ys(l);let m=0;const y=new Array(o),B=new Array(o);let g=0;const b=new Uint8Array(r.buffer);for(let C=0;C<o;C++){const N=C<c?u:v;y[C]=b.slice(m,m+N),B[C]=d.encode(y[C]),m+=N,g=Math.max(g,N)}const p=new Uint8Array(n);let f=0,E,A;for(E=0;E<g;E++)for(A=0;A<o;A++)E<y[A].length&&(p[f++]=y[A][E]);for(E=0;E<l;E++)for(A=0;A<o;A++)p[f++]=B[A][E];return p}function Ns(r,t,e,n){let s;if(Array.isArray(r))s=Et.fromArray(r);else if(typeof r=="string"){let h=t;if(!h){const u=Et.rawSplit(r);h=ht.getBestVersionForData(u,e)}s=Et.fromString(r,h||40)}else throw new Error("Invalid data");const i=ht.getBestVersionForData(s,e);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=Ts(t,e,s),a=mt.getSymbolSize(t),c=new ps(a);return vs(c,t),Es(c),As(c,t),At(c,e,0),t>=7&&Cs(c,t),Bs(c,o),isNaN(n)&&(n=Lt.getBestMask(c,At.bind(null,c,e))),Lt.applyMask(n,c),At(c,e,n),{modules:c,version:t,errorCorrectionLevel:e,maskPattern:n,segments:s}}Se.create=function(t,e){if(typeof t=="undefined"||t==="")throw new Error("No input text");let n=vt.M,s,i;return typeof e!="undefined"&&(n=vt.from(e.errorCorrectionLevel,vt.M),s=ht.from(e.version),i=Lt.from(e.maskPattern),e.toSJISFunc&&mt.setToSJISFunction(e.toSJISFunc)),Ns(t,s,n,i)};var Ke={},Ht={};(function(r){function t(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let n=e.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+e);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(i){return[i,i]}))),n.length===6&&n.push("F","F");const s=parseInt(n.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+n.slice(0,6).join("")}}r.getOptions=function(n){n||(n={}),n.color||(n.color={});const s=typeof n.margin=="undefined"||n.margin===null||n.margin<0?4:n.margin,i=n.width&&n.width>=21?n.width:void 0,o=n.scale||4;return{width:i,scale:i?4:o,margin:s,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},r.getScale=function(n,s){return s.width&&s.width>=n+s.margin*2?s.width/(n+s.margin*2):s.scale},r.getImageWidth=function(n,s){const i=r.getScale(n,s);return Math.floor((n+s.margin*2)*i)},r.qrToImageData=function(n,s,i){const o=s.modules.size,a=s.modules.data,c=r.getScale(o,i),h=Math.floor((o+i.margin*2)*c),u=i.margin*c,v=[i.color.light,i.color.dark];for(let l=0;l<h;l++)for(let d=0;d<h;d++){let m=(l*h+d)*4,y=i.color.light;if(l>=u&&d>=u&&l<h-u&&d<h-u){const B=Math.floor((l-u)/c),g=Math.floor((d-u)/c);y=v[a[B*o+g]?1:0]}n[m++]=y.r,n[m++]=y.g,n[m++]=y.b,n[m]=y.a}}})(Ht);(function(r){const t=Ht;function e(s,i,o){s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}r.render=function(i,o,a){let c=a,h=o;typeof c=="undefined"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(h=n()),c=t.getOptions(c);const u=t.getImageWidth(i.modules.size,c),v=h.getContext("2d"),l=v.createImageData(u,u);return t.qrToImageData(l.data,i,c),e(v,h,u),v.putImageData(l,0,0),h},r.renderToDataURL=function(i,o,a){let c=a;typeof c=="undefined"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const h=r.render(i,o,c),u=c.type||"image/png",v=c.rendererOpts||{};return h.toDataURL(u,v.quality)}})(Ke);var $e={};const Ss=Ht;function oe(r,t){const e=r.a/255,n=t+'="'+r.hex+'"';return e<1?n+" "+t+'-opacity="'+e.toFixed(2).slice(1)+'"':n}function Ct(r,t,e){let n=r+t;return typeof e!="undefined"&&(n+=" "+e),n}function Os(r,t,e){let n="",s=0,i=!1,o=0;for(let a=0;a<r.length;a++){const c=Math.floor(a%t),h=Math.floor(a/t);!c&&!i&&(i=!0),r[a]?(o++,a>0&&c>0&&r[a-1]||(n+=i?Ct("M",c+e,.5+h+e):Ct("m",s,0),s=0,i=!1),c+1<t&&r[a+1]||(n+=Ct("h",o),o=0)):s++}return n}$e.render=function(t,e,n){const s=Ss.getOptions(e),i=t.modules.size,o=t.modules.data,a=i+s.margin*2,c=s.color.light.a?"<path "+oe(s.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",h="<path "+oe(s.color.dark,"stroke")+' d="'+Os(o,i,s.margin)+'"/>',u='viewBox="0 0 '+a+" "+a+'"',v=s.width?'width="'+s.width+'" height="'+s.width+'" ':"",l='<svg xmlns="http://www.w3.org/2000/svg" '+v+u+' shape-rendering="crispEdges">'+c+h+`</svg>
`;return typeof n=="function"&&n(null,l),l};const Ms=zr,ae=Se,qe=Ke,Rs=$e;function Jt(r,t,e,n,s){const i=[].slice.call(arguments,1),o=i.length,a=typeof i[o-1]=="function";if(!a&&!Ms())throw new Error("Callback required as last argument");if(a){if(o<2)throw new Error("Too few arguments provided");o===2?(s=e,e=t,t=n=void 0):o===3&&(t.getContext&&typeof s=="undefined"?(s=n,n=void 0):(s=n,n=e,e=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(e=t,t=n=void 0):o===2&&!t.getContext&&(n=e,e=t,t=void 0),new Promise(function(c,h){try{const u=ae.create(e,n);c(r(u,t,n))}catch(u){h(u)}})}try{const c=ae.create(e,n);s(null,r(c,t,n))}catch(c){s(c)}}var Ls=Jt.bind(null,qe.render);Jt.bind(null,qe.renderToDataURL);Jt.bind(null,function(r,t,e){return Rs.render(r,e)});class ze extends lt{constructor(){super(...arguments);U(this,"link",qr())}connect(){super.connect(),this.link.onPair(()=>this.onPair()),this.link.on("message",s=>this.onMessage(s));const n=new URLSearchParams(window.location.search).get("id");n&&(this.pairInput.value=n),window.history.replaceState(null,null,window.location.protocol+"//"+window.location.host+window.location.pathname)}onPair(){this.pairButton.innerText="Paired !",this.waitingTarget.classList.add("hidden"),this.pairedTarget.classList.remove("hidden")}onMessage(e){this.messageOutput.innerText=e}async pair(e){e.preventDefault(),this.pairButton.disabled=!0,this.pairInput.disabled=!0;const{id:n}=await this.link.pair(this.pairInput.value);this.pairInput.value=n,this.pairButton.innerText="Waiting for peer to connect...",this.waitingTarget.classList.remove("hidden"),this.createQR()}createQR(){const e=window.location.href+"?id="+this.pairId;Ls(this.qrcodeTarget,e)}async copyId(e){await navigator.clipboard.writeText(this.pairId);const n=e.target.innerText;e.target.innerText="Copied !",e.target.disabled=!0,setTimeout(()=>{e.target.innerText=n,e.target.disabled=!1},3e3)}send(e){e.preventDefault(),this.link.emit("message",this.messageInput.value),this.messageInput.value=""}get pairInput(){return this.pairInputTarget}get messageInput(){return this.messageInputTarget}get messageOutput(){return this.messageOutputTarget}get pairId(){return this.link.id}get pairButton(){return this.pairButtonTarget}}U(ze,"targets",["pairInput","pairButton","waiting","paired","messageInput","messageOutput","qrcode"]);const _s=Dt.start();_s.register("demo",ze);
